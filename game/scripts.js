!function(){var e={776:function(){document.addEventListener("DOMContentLoaded",(()=>{const e=document.body.querySelector(".gameResults"),t=e?.querySelector(".gameResults__newGameBtn")??null;t?.addEventListener("click",(e=>{e.preventDefault(),location.reload()}))}))},427:function(e){e.exports={toggleClsInList:function(e,t,n){e.forEach(((e,s)=>{const r=Number.isFinite(t)?s===t:e===t;e.classList.toggle(n,r)}))},formatNumeralItem:function(e,t){let n=`${e} `;if((e%=100)>=11&&e<=19)n+=t[2];else switch(e%10){case 1:n+=t[0];break;case 2:case 3:case 4:n+=t[1];break;default:n+=t[2]}return n},isPlainObject:function(e){return"object"==typeof e&&null!==e&&e.constructor===Object&&"[object Object]"===Object.prototype.toString.call(e)},formatTime:function(e){const t=60*(new Date).getTimezoneOffset()*1e3;return new Date(e+t).toLocaleTimeString().replace(/^(00:)?/,"")},prettyDateTime:function(e=new Date){const t=e.toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"});return`${e.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}, ${t}`},toggleDisabled:function(e,t){e.disabled=void 0===t?!e.disabled:t}}}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var a=t[s]={exports:{}};return e[s](a,a.exports,n),a.exports}!function(){"use strict";class e{events={};_availiableEvents=[];on(e,t){if(!this._checkEvent(e))throw new Error(`Unknown event ${e}`);this.events[e]||(this.events[e]=[]),this.events[e].push(t)}emit(e,...t){if(!this._checkEvent(e))throw new Error(`Unknown event ${e}`);this.events[e]&&this.events[e].forEach((e=>{e(...t)}))}off(e,t){this.events[e]&&(this.events[e]=this.events[e].filter((e=>e!==t)))}_checkEvent(e){return!this._availiableEvents.length||this._availiableEvents.includes(e)}}function t(e,t){let n;try{n=e()}catch(e){if(s(e),t)try{n=t()}catch(e){s(e)}}return n}function s(e){alert(`Произошла ошибка: \n    ${e instanceof Error?e.message:"string"==typeof e&&e.length?e:"неизвестная ошибка"}\n  `),console.error(e)}var r=JSON.parse('{"CoolUser":[{"score":100,"datetime":123131232,"gametime":543,"clicks":150,"caught":5,"missed":7},{"score":200,"datetime":45123131232,"gametime":456,"clicks":230,"caught":34,"missed":56}],"zombie88":[{"score":100,"datetime":123131232,"gametime":543,"clicks":150,"caught":5,"missed":7},{"score":200,"datetime":45123131232,"gametime":456,"clicks":230,"caught":34,"missed":56}],"Pe40nkin":[{"score":100,"datetime":123131232,"gametime":543,"clicks":150,"caught":5,"missed":7}]}'),a=new class{_emitter=new e;_stats=[];constructor(){this.users.length||t((()=>{localStorage.setItem("gameStats",JSON.stringify(r))}))}set user(e){null===e?localStorage.removeItem("user"):localStorage.setItem("user",e)}get user(){return localStorage.getItem("user")}get users(){return Object.entries(this.gameStats).map((([e])=>e))}get gameStats(){return t((()=>{const e=localStorage.getItem("gameStats");return e?JSON.parse(e):{}}),(()=>({})))}regGameStat(e){const n=this.user||"";if(!n)throw new Error("No user for reg stat");const s=this.gameStats?.[n]??[];s.push(e),t((()=>{localStorage.setItem("gameStats",JSON.stringify({...this.gameStats,[n]:s}))}))}on(e,t){this._emitter.on(e,t)}startGame(){this._emitter.emit("gameStarted")}finishGame(){this._emitter.emit("gameFinished")}clearGameStats(){localStorage.removeItem("gameStats")}};const o={score:0,datetime:0,gametime:0,clicks:0,caught:0,missed:0};class i{_stats=o;_emitter=new e;get stats(){return this._stats}get isPaused(){return!1}start(){this._stats={score:111,datetime:Date.now(),gametime:543,clicks:150,caught:5,missed:7}}finish(){}pause(){}resume(){}on(e,t){this._emitter.on(e,t)}}var c=new class{_scoreCounter=null;_timeCounter=null;build(){const e=document.body.querySelector(".gamePlayground")??null,t=e?.querySelector(".gamePlayground__finishBtn")??null;t?.addEventListener("click",(e=>{e.preventDefault(),a.finishGame()})),this._timeCounter=e?.querySelector(".gamePlayground__indicator_time")??null,this._scoreCounter=e?.querySelector(".gamePlayground__indicator_score")??null}set score(e){this._scoreCounter&&(this._scoreCounter.textContent=e)}set time(e){this._timeCounter&&(this._timeCounter.textContent=e)}};function l(e){const t=t=>e[t.key]?.(t);return document.body.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)}var u=n(427);document.addEventListener("DOMContentLoaded",(()=>{document.body.querySelectorAll(".tabs").forEach((e=>{const t=Array.from(e.querySelectorAll(".tabs__tab")??[]);t.forEach((n=>{n.addEventListener("click",(n=>{const s=n.currentTarget,r=t.indexOf(s),a=Array.from(e.querySelectorAll(".tabs__content")??[]);(0,u.toggleClsInList)(t,s,"tabs__tab_active"),(0,u.toggleClsInList)(a,r,"tabs__content_opened")}))}))}))}));document.addEventListener("DOMContentLoaded",(()=>{const e=document.body.querySelector(".gameGreeting"),t=e?.querySelector(".gameGreeting__welcomeUser")??null,n=e?.querySelector(".gameGreeting__startBtn")??null;n?.addEventListener("click",(e=>{e.preventDefault(),a.startGame()})),l({Enter:()=>a.startGame()});const s=e?.querySelector(".gameGreeting__addUserInput")??null;s?.addEventListener("input",(function(e){const t=e.target;r&&(0,u.toggleDisabled)(r,!1),t.value.length>5&&c(t.value)})),s?.addEventListener("paste",(function(e){const t=e.clipboardData?.getData("text")??"";r&&(0,u.toggleDisabled)(r,!1),c(t)||e.preventDefault()}));const r=e?.querySelector(".gameGreeting__addUserBtn")??null;r?.addEventListener("click",(e=>{e.preventDefault();const t=s?.value??"";c(t)&&i(t)})),r&&(0,u.toggleDisabled)(r,!0);const o=e?.querySelector(".gameGreeting__chooseUserBtn")??null;function i(e){a.user=e,n&&(n.style.display=e?"initial":"none"),t&&(t.textContent=e||""),s&&(s.value="")}function c(e){const t=new RegExp("^[a-zA-Z0-9_-]{5,20}$").test(e);return t||(r&&(0,u.toggleDisabled)(r,!0),alert("Задано некорректное имя!")),t}o?.addEventListener("click",(t=>{t.preventDefault();const n=e?.querySelector("input[type='radio'][name='users']:checked")??null,s=n?.value;s&&i(s)})),i(a.user)}));n(776);let m,d,g,h,_;a.on("gameStarted",(()=>{m=new i,m.start(),m.on("scoreChanged",(e=>{c.score=e})),m.on("timeChanged",(e=>{c.time=e})),_=l({Escape:()=>a.finishGame()," ":()=>m.isPaused?m.resume():m.pause()}),d&&(d.style.display="none"),g&&(g.style.display="block"),h&&(h.style.display="none")})),a.on("gameFinished",(()=>{m.finish(),a.regGameStat(m.stats),_(),g&&(g.style.display="none"),h&&(h.style.display="block")})),document.addEventListener("DOMContentLoaded",(()=>{d=document.body.querySelector(".game__greeting"),g=document.body.querySelector(".game__playground"),h=document.body.querySelector(".game__results"),c.build()}))}()}();